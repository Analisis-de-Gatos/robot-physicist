name: Quarto Publish (FÃ­sico Remoto CI/CD)

on:
  # Se ejecuta con cada 'push' a la rama principal
  push:
    branches: [main]
  workflow_dispatch:

jobs:
  build-and-deploy:
    runs-on: ubuntu-latest

    permissions:
      contents: write 
      pages: write    
      id-token: write 

    steps:
      - name: â¬‡ï¸ Checkout del Repositorio
        uses: actions/checkout@v4

      # --- PASO 1: ConfiguraciÃ³n del Entorno (Quarto y Python) ---
      # Esta acciÃ³n se encarga de instalar Python, pip y Quarto.
      - name: ğŸ› ï¸ Configurar Quarto y Python
        uses: quarto-dev/quarto-actions/setup@v2
        with:
          version: '1.8.25' 
          python-version: '3.11' 

      - name: ğŸ“¦ Instalar dependencias de Python (uproot, marimo, hist, etc.)
        # Usa el archivo requirements.txt creado en el Paso 1
        run: |
          pip install -r requirements.txt

      # --- PASO 2: Descarga de Datos (Tu cÃ³digo de anÃ¡lisis puede hacer esto) ---
      # Si el cÃ³digo de anÃ¡lisis en el .qmd descarga los datos, puedes omitir este paso.
      - name: ğŸ“¥ (Opcional) Script de Descarga de Datos
        run: echo "El cÃ³digo de anÃ¡lisis en Quarto manejarÃ¡ la descarga y lectura."
          
      # --- PASO 3: AnÃ¡lisis y Renderizado Quarto ---
      - name: âš™ï¸ Ejecutar AnÃ¡lisis y Renderizado del Sitio Quarto
        # IMPORTANTÃSIMO: Navegar al subdirectorio donde estÃ¡ el proyecto Quarto
        run: |
          cd robot-physicist-website
          quarto render

      # --- PASO 4: Despliegue a GitHub Pages ---
      - name: âš™ï¸ Configurar GitHub Pages
        uses: actions/configure-pages@v4
        with:
          # La carpeta de salida es la subcarpeta del proyecto Quarto
          static_site_root: 'robot-physicist-website/_site' 
          
      - name: ğŸš€ Subir artefacto para Pages
        uses: actions/upload-pages-artifact@v3
        with:
          path: 'robot-physicist-website/_site' 

      - name: ğŸŒ Desplegar a GitHub Pages
        id: deployment
        uses: actions/deploy-pages@v4
